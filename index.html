<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tieg Digital</title><style>
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#0b1020;color:#fff}
header{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:#0f172a}
.logo{font-size:20px;font-weight:bold}
.btn{background:#0ea5e9;border:none;padding:8px 14px;border-radius:6px;color:#fff;cursor:pointer;margin-left:8px}
.hero{text-align:center;padding:60px 20px}
.pricing{display:flex;gap:20px;justify-content:center;flex-wrap:wrap;padding:30px}
.card{background:#111936;padding:22px;border-radius:12px;width:260px;text-align:center}
.buy{margin-top:14px;background:#0ea5e9;border:none;padding:10px 18px;border-radius:6px;color:#fff;cursor:pointer}

/* CHAT */
#chatPanel{position:fixed;right:0;top:0;height:100%;width:50%;background:#0f172a;display:none;flex-direction:column;z-index:10}
@media(max-width:768px){#chatPanel{width:100%}}
#chatHeader{padding:14px;background:#111936;display:flex;justify-content:space-between;align-items:center}
#chatMessages{flex:1;overflow-y:auto;padding:14px}
.msg{padding:8px 12px;border-radius:8px;margin:6px 0;max-width:75%}
.userMsg{background:#0ea5e9;margin-left:auto}
.adminMsg{background:#1e293b}
#chatInputBox{display:flex;padding:10px;background:#111936}
#chatInput{flex:1;padding:8px;border:none;border-radius:6px}

/* ADMIN */
#adminPanel{position:fixed;left:0;top:0;height:100%;width:40%;background:#020617;display:none;flex-direction:column;z-index:11;border-right:2px solid #0ea5e9}
@media(max-width:768px){#adminPanel{width:100%}}
#adminHeader{padding:14px;border-bottom:1px solid #0ea5e9}
#userList{flex:1;overflow-y:auto}
.userItem{padding:12px;border-bottom:1px solid #111936;cursor:pointer}
.userItem:hover{background:#111936}

/* MODALS */
.modal{display:none;position:fixed;inset:0;background:#0008;align-items:center;justify-content:center;z-index:20}
.modalBox{background:#111936;padding:20px;border-radius:10px;width:260px}
.modalBox input{width:100%;padding:8px;margin:6px 0;border:none;border-radius:6px}
</style></head>
<body><header>
<div class="logo">Tieg Digital</div>
<div>
<button class="btn" onclick="showLogin()">Login</button>
<button class="btn" onclick="showSignup()">Sign Up</button>
<button class="btn" onclick="logout()">Logout</button>
</div>
</header><section class="hero">
<h1>Premium Business Website</h1>
<p>Live admin chat included</p>
</section><section class="pricing">
<div class="card"><h3>Basic</h3><p>$300</p><button class="buy" onclick="openChat()">Buy</button></div>
<div class="card"><h3>Standard</h3><p>$500</p><button class="buy" onclick="openChat()">Buy</button></div>
<div class="card"><h3>Premium</h3><p>$900</p><button class="buy" onclick="openChat()">Buy</button></div>
</section><!-- ADMIN PANEL --><div id="adminPanel">
<div id="adminHeader">Admin Conversations</div>
<div id="userList"></div>
</div><!-- CHAT --><div id="chatPanel">
<div id="chatHeader">
<span id="chatTitle">Chat</span>
<button class="btn" onclick="closeChat()">Back</button>
</div>
<div id="chatMessages"></div>
<div id="chatInputBox">
<input id="chatInput" placeholder="Type message...">
<button class="btn" onclick="sendMsg()">Send</button>
</div>
</div><!-- LOGIN --><div id="loginModal" class="modal"><div class="modalBox">
<h3>Login</h3>
<input id="loginEmail" placeholder="Email">
<input id="loginPass" type="password" placeholder="Password">
<button class="btn" onclick="login()">Login</button>
</div></div><!-- SIGNUP --><div id="signupModal" class="modal"><div class="modalBox">
<h3>Sign Up</h3>
<input id="signupEmail" placeholder="Email">
<input id="signupPass" type="password" placeholder="Password">
<button class="btn" onclick="signup()">Create</button>
</div></div><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script><script>
const firebaseConfig={
apiKey:"AIzaSyDzeFZfqReHMHaZMlIfrfqAyjG3v2nfj-4",
authDomain:"content-platform-5a902.firebaseapp.com",
projectId:"content-platform-5a902"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

const ADMIN_EMAIL="tiegmicheal@gmail.com";
let currentUser=null;
let currentChatUID=null;
let unsubscribe=null;
let adminUnsub=null;

// AUTH STATE
auth.onAuthStateChanged(user=>{
currentUser=user;
if(!user){chatPanel.style.display="none";adminPanel.style.display="none";return}

if(user.email===ADMIN_EMAIL){
adminPanel.style.display="flex";
listenConversations();
}else{
currentChatUID=user.uid;
listenMessages(user.uid);
}
});

function showLogin(){loginModal.style.display="flex"}
function showSignup(){signupModal.style.display="flex"}

function login(){
auth.signInWithEmailAndPassword(loginEmail.value.trim(),loginPass.value.trim())
.then(()=>{loginModal.style.display="none";alert("Login successful")})
.catch(()=>alert("Incorrect email or password"));
}

function signup(){
auth.createUserWithEmailAndPassword(signupEmail.value.trim(),signupPass.value.trim())
.then(()=>{signupModal.style.display="none";alert("Account created")})
.catch(()=>alert("Signup failed"));
}

function logout(){auth.signOut().then(()=>alert("Logged out"))}

function openChat(){
if(!currentUser){showLogin();return}
chatPanel.style.display="flex";
}
function closeChat(){chatPanel.style.display="none"}

function sendMsg(){
const text=chatInput.value.trim();
if(!text||!currentUser)return;

const uid=currentUser.email===ADMIN_EMAIL?currentChatUID:currentUser.uid;
if(!uid)return;

const convoRef=db.collection("conversations").doc(uid);
convoRef.set({
userEmail: currentUser.email===ADMIN_EMAIL?chatTitle.textContent:currentUser.email,
updatedAt: Date.now(),
lastMessage: text
},{merge:true});

convoRef.collection("messages").add({
text:text,
sender: currentUser.email===ADMIN_EMAIL?"admin":"user",
time: Date.now()
});

chatInput.value="";
}

function listenMessages(uid){
if(unsubscribe)unsubscribe();
unsubscribe=db.collection("conversations").doc(uid).collection("messages").orderBy("time")
.onSnapshot(snap=>{
chatMessages.innerHTML="";
snap.forEach(doc=>{
const m=doc.data();
const div=document.createElement("div");
div.className="msg "+(m.sender==="admin"?"adminMsg":"userMsg");
div.textContent=(m.sender==="admin"?"Admin: ":"You: ")+m.text;
chatMessages.appendChild(div);
});
chatMessages.scrollTop=chatMessages.scrollHeight;
});
}

function listenConversations(){
if(adminUnsub)adminUnsub();
adminUnsub=db.collection("conversations").orderBy("updatedAt","desc")
.onSnapshot(snap=>{
userList.innerHTML="";
snap.forEach(doc=>{
const d=doc.data();
const div=document.createElement("div");
div.className="userItem";
div.textContent=d.userEmail;
div.onclick=()=>openAdminChat(doc.id,d.userEmail);
userList.appendChild(div);
});
});
}

function openAdminChat(uid,email){
currentChatUID=uid;
chatTitle.textContent=email;
chatPanel.style.display="flex";
listenMessages(uid);
}
</script></body>
</html>